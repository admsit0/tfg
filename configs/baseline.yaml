data:
  dataset: mnist  # Options: cifar10, mnist
  data_dir: ./data
  batch_size: 128
  subset_ratio: 1
  test_subset_ratio: 1
  train_split: 0.8
  augment: false

model:
  name: simple_cnn
  kwargs:
    num_classes: 10  # For MNIST and CIFAR-10

loss:
  name: cross_entropy
  kwargs: {}

optim:
  name: sgd
  lr: 0.1
  weight_decay: 0.0005
  momentum: 0.9
  scheduler:
    name: cosine
    T_max: 200

trainer:
  max_epochs: 2
  out_dir: runs/baseline
  seed: 42

regularizers: []

analysis:
  collect_activations: true
  # Precision for activation vector comparison (num_states)
  precision: 1000
  # Layer to collect activations from
  layers: 'relu4'  # For SimpleCIFARNet: conv1, relu1, conv2, relu2, pool1, dropout1, conv3, relu3, conv4, relu4, pool2, dropout2, conv5, relu5, avgpool

  # Quantize activations before storing (optional float). If provided, activations
  # will be rounded to multiples of this step. Use null or omit to disable.
  quantize: 0.01

  # When to collect activations. Valid forms:
  # - int (epoch index, 0-based): collect only that epoch
  # - list of ints: collect multiple specific epochs
  # - 'initial'|'middle'|'final' (strings): collect first, middle or last epoch
  # - null/omit: do not collect automatically
  # Examples:
  # collect_epochs: 0
  # collect_epochs: [0,10,49]
  # collect_epochs: 'initial'
  # collect_epochs: 'middle'
  # collect_epochs: 'final'
  collect_epochs: 'final'

  # Filename for the JSON that will contain flattened activations per-layer per-epoch.
  # If the file already exists it will be merged (epochs/layers added) rather
  # than overwritten entirely.
  activations_filename: activations_collected.json

  # Notes:
  # - Activations are stored as flattened lists of numbers (floats) under
  #   export[layer_name]["<epoch_index>"] = {"activations": [ ... ]}
  # - Layer keys correspond to the exact `named_modules()` names discovered in the model.

visualization:
  enabled: true
  host: http://127.0.0.1
  port: 8765
  send_batch_metrics: true
  send_every_n_batches: 10
  send_activations: true
  max_activation_thumbnails: 4
  